
services:
  # 1. Deep Learning Classifier Service (TensorFlow/MobileNetV2) 
  mobile-net-classifier:
    build:
      context: ./mobile_net_classifier
      dockerfile: Dockerfile
    container_name: mobile-net-classifier
# Service runs on port 5000 (internal network only)
    command: ["flask", "run", "--host=0.0.0.0", "--port=5000"]
    restart: always

  # 2. Packet Agent API Service (Converts data and calls classifier) 
  packet-agent:
    build:
      context: ./packet_agent
      dockerfile: Dockerfile
    container_name: packet-agent
# Service runs on port 5001 (internal network only)
    command: ["python", "agent.py"]
    depends_on:
    - mobile-net-classifier
    restart: always

  # 3. Interactive Frontend Dashboard (The user interface) 
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: frontend
# Expose to host machine so you can view it at http://localhost:8080
    ports:
    - "8080:8080"
    depends_on:
    - packet-agent
    restart: always

  # 4. Background Traffic Generator (Optional/Simulation only) 
  traffic-gen:
    build:
      context: ./traffic_gen
      dockerfile: Dockerfile
    container_name: traffic-gen
    depends_on:
    - packet-agent
    restart: always